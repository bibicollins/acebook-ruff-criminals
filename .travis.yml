env:
  global:
    - CC_TEST_REPORTER_ID=89f7dbadec8ea3cdc6c8927a6029651d2e8243819ce79a4e2288eea12fcda172
language: ruby
rvm:
  - 2.5.0
before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
  - sleep 3
  - rails db:create RAILS_ENV=test
  - rails db:migrate RAILS_ENV=test
  - bundle exec rspec
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
install:
  - bundle install
before_install:
  - gem install bundler

deploy:
      provider: heroku
      api_key:
        secure:
          "nf4Rh8sjMBDS2wvLx+4+yj02NGPcpZL9z9X4/UMg/If7nMybnm2rYUrW3UEDuJTgT9X5PvbpAquBMQl0QKT3oWpkqL83zmDJ8KgI8jEBfZIaSb5HSy2K8J7DlJMDfK5E1meDOeiJpznMaPK42lQlAhQMBwIpdw/PLS/fNaVeePXbF56LlZoIipPd38gUeo/iT6YbsWbhV9wV3EQd2Hkyuq9kXRQG/H9pkjFmfmUuEl+QWa0kDpkZtDYW0raKw1+fJkiyyTYFGnSDCejnJMU0O+yvZzb5uStpR1VLYdil/TPMqAr5feDLFWmpoIBnS3ZSUb9KrsATEhtdfjrwq1HCrbYLnQJwLk+Pjc26chFEKn5jk0MC+C2FBVeI4q77Md8YCxgbRuOUPDt7VKga8Fr9dZzi/tvmxtK4OSlt5WejuCM5kaKTEv77D5aB9NqDrN1lDSaZRenC7tzvjGeak+r6Pz58m0H15GYcYejTQxi9V2jfO/2w4J29F6G36p2xC0SRNtho6Sih+LdViWWm2MyYv9y+sM68ucLvJ2670yJapPdhCdduZzudZjwqlds0g4RvPJ563Mj90ZQIeNRBqp9yDrl4vSSG3+fL5E7CjiGqY8LKOYdEMvPmsVj4GQO7mq2lfC8oyY4VOQ82MLlgAt3YLPGvHdCO5mufXReyBlh9UpY="
        app: ruffbook
        on:
          repo: danieljonesdmj/acebook-ruff-criminals
        run:
          - "rake db:migrate"
          - restart
          - "rake cleanup"
